pipeline = train_with_rules_and_threshold(train_data, target_precision=0.97, consider_last_k_triplets=7)

=============================================================================================

Deterministic metrics (threshold=0.5): precision=0.7950, recall=0.8746, f1=0.8329, auc=0.9143
Deterministic metrics (threshold=0.5): precision=0.8561, recall=0.9294, f1=0.8913, auc=0.9622
Deterministic metrics (threshold=0.5): precision=0.9603, recall=0.9599, f1=0.9601, auc=0.9937

=============================================================================================

GridSearch best params: {'clf__l2_regularization': 1.0, 'clf__learning_rate': 0.1, 'clf__max_depth': 10, 'clf__max_iter': 500}

Sentinel triplet: (7, 135, 323) rel_freq: 0.01870798012277112

Chosen threshold for target_precision 0.97 : 0.633245382585752

Demo idx 22107: decision=True, prob=0.9998, reason=ml_threshold

Diagnostics: {'sequence_hash': 'e00221ba544f6c7011ed9301cf4971784ca30c3f9cf2b6e5a9a6acfc779a93ea', 'feature_vector': {'length': 84.0, 'mod3': 0.0, 'unique_count': 22.0, 'checksum_comp': 374399.0, 'bitmask': 533193.0, 'mean': 152.17857142857142, 'std': 127.40450772415933, 'median': 134.0, 'min': 0.0, 'max': 322.0, 'entropy': 3.6984977105955084, 'p10': 3.900000000000002, 'p25': 6.75, 'p75': 314.25, 'p90': 317.0, 'last_triplet_hash': 154890.0, 'pref_0': 0.0, 'pref_1': 134.0, 'pref_2': 322.0, 'pref_3': 6.0, 'pref_4': 134.0, 'pref_5': 321.0, 'pref_6': 6.0, 'pref_7': 134.0, 'pref_8': 319.0, 'pref_9': 7.0, 'pref_10': 134.0, 'pref_11': 317.0, 'suff_0': 9.0, 'suff_1': 131.0, 'suff_2': 314.0, 'suff_3': 3.0, 'suff_4': 131.0, 'suff_5': 316.0, 'suff_6': 3.0, 'suff_7': 134.0, 'suff_8': 319.0, 'suff_9': 6.0, 'suff_10': 156.0, 'suff_11': 317.0, 'last_diff_0': -313.0, 'last_diff_1': 150.0, 'last_diff_2': 161.0, 'bigram_sum_0': 3.0, 'bigram_sum_1': 3.0, 'bigram_sum_2': 5.0, 'bigram_sum_3': 3.0, 'bigram_sum_4': 2.0, 'bigram_sum_5': 6.0, 'trigram_sum_0': 4.0, 'trigram_sum_1': 3.0, 'trigram_sum_2': 3.0, 'trigram_sum_3': 6.0}, 'threshold': 0.633245382585752}

Demo idx 97909: decision=True, prob=0.9977, reason=ml_threshold
Diagnostics: {'sequence_hash': '7482b79427f1e21dffde765f85f2e2e1aa6c1a50d7750e1e077a715e6c006088', 'feature_vector': {'length': 90.0, 'mod3': 0.0, 'unique_count': 16.0, 'checksum_comp': 511373.0, 'bitmask': 65937.0, 'mean': 151.33333333333334, 'std': 127.5273391168428, 'median': 131.0, 'min': 0.0, 'max': 320.0, 'entropy': 3.470151081019071, 'p10': 4.0, 'p25': 8.0, 'p75': 315.0, 'p90': 320.0, 'last_triplet_hash': 14811.0, 'pref_0': 0.0, 'pref_1': 129.0, 'pref_2': 315.0, 'pref_3': 4.0, 'pref_4': 129.0, 'pref_5': 315.0, 'pref_6': 4.0, 'pref_7': 133.0, 'pref_8': 315.0, 'pref_9': 8.0, 'pref_10': 129.0, 'pref_11': 315.0, 'suff_0': 4.0, 'suff_1': 131.0, 'suff_2': 320.0, 'suff_3': 4.0, 'suff_4': 135.0, 'suff_5': 318.0, 'suff_6': 8.0, 'suff_7': 131.0, 'suff_8': 316.0, 'suff_9': 4.0, 'suff_10': 155.0, 'suff_11': 320.0, 'last_diff_0': -312.0, 'last_diff_1': 151.0, 'last_diff_2': 165.0, 'bigram_sum_0': 1.0, 'bigram_sum_1': 6.0, 'bigram_sum_2': 5.0, 'bigram_sum_3': 4.0, 'bigram_sum_4': 3.0, 'bigram_sum_5': 2.0, 'trigram_sum_0': 6.0, 'trigram_sum_1': 0.0, 'trigram_sum_2': 1.0, 'trigram_sum_3': 4.0}, 'threshold': 0.633245382585752}

Demo idx 55381: decision=True, prob=0.9923, reason=ml_threshold
Diagnostics: {'sequence_hash': '968289199fc6c7e2620525acfa75d80b46329d8b0e3a75dad241b1042e503797', 'feature_vector': {'length': 168.0, 'mod3': 0.0, 'unique_count': 14.0, 'checksum_comp': 280486.0, 'bitmask': 25.0, 'mean': 150.32738095238096, 'std': 128.52234829860606, 'median': 131.0, 'min': 0.0, 'max': 326.0, 'entropy': 2.9424583778657203, 'p10': 3.0, 'p25': 4.0, 'p75': 313.5, 'p90': 318.0, 'last_triplet_hash': 456143.0, 'pref_0': 0.0, 'pref_1': 131.0, 'pref_2': 323.0, 'pref_3': 3.0, 'pref_4': 131.0, 'pref_5': 318.0, 'pref_6': 4.0, 'pref_7': 131.0, 'pref_8': 315.0, 'pref_9': 4.0, 'pref_10': 131.0, 'pref_11': 311.0, 'suff_0': 4.0, 'suff_1': 131.0, 'suff_2': 318.0, 'suff_3': 3.0, 'suff_4': 131.0, 'suff_5': 313.0, 'suff_6': 4.0, 'suff_7': 131.0, 'suff_8': 310.0, 'suff_9': 3.0, 'suff_10': 131.0, 'suff_11': 306.0, 'last_diff_0': -307.0, 'last_diff_1': 128.0, 'last_diff_2': 175.0, 'bigram_sum_0': 0.0, 'bigram_sum_1': 2.0, 'bigram_sum_2': 0.0, 'bigram_sum_3': 1.0, 'bigram_sum_4': 3.0, 'bigram_sum_5': 2.0, 'trigram_sum_0': 1.0, 'trigram_sum_1': 2.0, 'trigram_sum_2': 6.0, 'trigram_sum_3': 3.0}, 'threshold': 0.633245382585752}

Demo idx 110482: decision=True, prob=0.9977, reason=ml_threshold
Diagnostics: {'sequence_hash': '509327f46bb35084e17566384904938141bbe041dcdf7b770cb4419939a9b321', 'feature_vector': {'length': 81.0, 'mod3': 0.0, 'unique_count': 27.0, 'checksum_comp': 973917.0, 'bitmask': 33702901.0, 'mean': 152.14814814814815, 'std': 126.95416798268414, 'median': 131.0, 'min': 0.0, 'max': 324.0, 'entropy': 4.256930337752061, 'p10': 5.0, 'p25': 9.0, 'p75': 314.0, 'p90': 319.0, 'last_triplet_hash': 1027208.0, 'pref_0': 0.0, 'pref_1': 131.0, 'pref_2': 319.0, 'pref_3': 4.0, 'pref_4': 131.0, 'pref_5': 317.0, 'pref_6': 8.0, 'pref_7': 130.0, 'pref_8': 315.0, 'pref_9': 4.0, 'pref_10': 131.0, 'pref_11': 312.0, 'suff_0': 7.0, 'suff_1': 131.0, 'suff_2': 315.0, 'suff_3': 4.0, 'suff_4': 131.0, 'suff_5': 317.0, 'suff_6': 8.0, 'suff_7': 131.0, 'suff_8': 319.0, 'suff_9': 5.0, 'suff_10': 150.0, 'suff_11': 314.0, 'last_diff_0': -314.0, 'last_diff_1': 145.0, 'last_diff_2': 164.0, 'bigram_sum_0': 3.0, 'bigram_sum_1': 6.0, 'bigram_sum_2': 5.0, 'bigram_sum_3': 2.0, 'bigram_sum_4': 1.0, 'bigram_sum_5': 0.0, 'trigram_sum_0': 1.0, 'trigram_sum_1': 0.0, 'trigram_sum_2': 3.0, 'trigram_sum_3': 2.0}, 'threshold': 0.633245382585752}

Demo idx 17434: decision=True, prob=0.9988, reason=ml_threshold
Diagnostics: {'sequence_hash': '56dc72e9aa841ea6f4716ce6811d6388b682fc8d6ec4aac152ad78cc7dbd0f81', 'feature_vector': {'length': 138.0, 'mod3': 0.0, 'unique_count': 26.0, 'checksum_comp': 270338.0, 'bitmask': 136177.0, 'mean': 153.30434782608697, 'std': 127.86437610510828, 'median': 132.0, 'min': 0.0, 'max': 324.0, 'entropy': 4.088154268033412, 'p10': 4.0, 'p25': 8.0, 'p75': 316.0, 'p90': 321.0, 'last_triplet_hash': 713422.0, 'pref_0': 0.0, 'pref_1': 145.0, 'pref_2': 319.0, 'pref_3': 17.0, 'pref_4': 136.0, 'pref_5': 318.0, 'pref_6': 9.0, 'pref_7': 136.0, 'pref_8': 316.0, 'pref_9': 8.0, 'pref_10': 132.0, 'pref_11': 316.0, 'suff_0': 17.0, 'suff_1': 132.0, 'suff_2': 321.0, 'suff_3': 4.0, 'suff_4': 132.0, 'suff_5': 321.0, 'suff_6': 5.0, 'suff_7': 136.0, 'suff_8': 323.0, 'suff_9': 8.0, 'suff_10': 196.0, 'suff_11': 323.0, 'last_diff_0': -315.0, 'last_diff_1': 188.0, 'last_diff_2': 127.0, 'bigram_sum_0': 0.0, 'bigram_sum_1': 0.0, 'bigram_sum_2': 5.0, 'bigram_sum_3': 0.0, 'bigram_sum_4': 6.0, 'bigram_sum_5': 1.0, 'trigram_sum_0': 2.0, 'trigram_sum_1': 3.0, 'trigram_sum_2': 4.0, 'trigram_sum_3': 2.0}, 'threshold': 0.633245382585752}